<ng-container>

  <div class="credit-page">

    <!-- HEADER -->
    <app-analyst-header
      role="ANALYST"
      (logout)="logout()">
    </app-analyst-header>

    <!-- CONTENT -->
    <main class="credit-container">
      <mat-card class="credit-card">

        <!-- ACTION BAR -->
        <div class="body-actions">
          <button
          mat-stroked-button
          class="back-btn"
          aria-label="Back to Analyst Dashboard"
          (click)="backToDashboard()">
          â† Back to Dashboard
        </button>
        </div>

        <!-- TITLE -->
        <h2 class="page-title">Reviewed Credit Requests</h2>

        <!-- CONTENT STATE -->
        <ng-container *ngIf="!loading; else loadingTpl">

          <ng-container *ngIf="creditRequests.length; else emptyTpl">
            <ng-template [ngTemplateOutlet]="tableTpl"></ng-template>
          </ng-container>

        </ng-container>

        <!-- LOADING -->
        <ng-template #loadingTpl>
          <p class="loading-text" aria-live="polite">
            Loading reviewed requestsâ€¦
          </p>
        </ng-template>

        <!-- EMPTY -->
        <ng-template #emptyTpl>
          <div class="empty-state">
            ğŸ“„ No reviewed credit requests found
          </div>
        </ng-template>

        <!-- TABLE TEMPLATE -->
        <ng-template #tableTpl>
          <table
            mat-table
            [dataSource]="creditRequests"
            class="mat-elevation-z8">
<!-- 
            <caption>Reviewed credit request details</caption> -->

            <ng-container matColumnDef="clientId">
              <th mat-header-cell *matHeaderCellDef>Client</th>
              <td mat-cell *matCellDef="let r">
                {{ r.clientId | slice:0:6 }}â€¦
              </td>
            </ng-container>

            <ng-container matColumnDef="requestedAmount">
              <th mat-header-cell *matHeaderCellDef>Amount</th>
              <td mat-cell *matCellDef="let r">
                â‚¹ {{ r.requestedAmount | number }}
              </td>
            </ng-container>

            <ng-container matColumnDef="tenureMonths">
              <th mat-header-cell *matHeaderCellDef>Tenure</th>
              <td mat-cell *matCellDef="let r">
                {{ r.tenureMonths }} months
              </td>
            </ng-container>

            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef>Status</th>
              <td mat-cell *matCellDef="let r">
                <span
                  class="status-pill"
                  [ngClass]="r.status?.toLowerCase()">
                  {{ r.status }}
                </span>
              </td>
            </ng-container>

            <ng-container matColumnDef="analystComment">
              <th mat-header-cell *matHeaderCellDef>Analyst Comment</th>
              <td mat-cell *matCellDef="let r">
                {{ r.analystComment || 'â€”' }}
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

          </table>
        </ng-template>

      </mat-card>
    </main>

    <!-- FOOTER -->
    <app-footer></app-footer>

  </div>

</ng-container>
