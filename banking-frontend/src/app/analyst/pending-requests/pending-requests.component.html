<div class="credit-page">

  <!-- HEADER -->
  <ng-container>
    <app-analyst-header
      role="ANALYST"
      (logout)="logout()">
    </app-analyst-header>
  </ng-container>

  <!-- CONTENT -->
  <main class="credit-container">
    <mat-card class="credit-card">

      <!-- ACTION BAR -->
      <div class="body-actions">
        <button
          mat-stroked-button
          class="back-btn"
          aria-label="Back to Analyst Dashboard"
          (click)="backToDashboard()">
          ‚Üê Back to Dashboard
        </button>
      </div>

      <!-- TITLE -->
      <h2 class="page-title">List of pending credit requests</h2>

      <!-- CONTENT STATE -->
      <ng-container *ngIf="!loading; else loadingTpl">

        <!-- ERROR -->
        <p class="error-text" *ngIf="errorMsg" role="alert">
          {{ errorMsg }}
        </p>

        <!-- TABLE -->
        <ng-container *ngIf="dataSource.data.length; else emptyTpl">
          <ng-template [ngTemplateOutlet]="tableTpl"></ng-template>
        </ng-container>

      </ng-container>

      <!-- LOADING -->
      <ng-template #loadingTpl>
        <p class="loading-text" aria-live="polite">
          Loading pending credit requests‚Ä¶
        </p>
      </ng-template>

      <!-- EMPTY -->
      <ng-template #emptyTpl>
        <div class="empty-state">
          üéâ No pending credit requests
        </div>
      </ng-template>

      <!-- TABLE TEMPLATE -->
      <ng-template #tableTpl>
        <table
          mat-table
          [dataSource]="dataSource"
          class="mat-elevation-z8">

          <!-- <caption>List of pending credit requests</caption> -->

          <ng-container matColumnDef="clientId">
            <th mat-header-cell *matHeaderCellDef>Client</th>
            <td mat-cell *matCellDef="let r">
              {{ r.clientId | slice:0:6 }}‚Ä¶
            </td>
          </ng-container>

          <ng-container matColumnDef="requestedAmount">
            <th mat-header-cell *matHeaderCellDef>Amount</th>
            <td mat-cell *matCellDef="let r">
              ‚Çπ {{ r.requestedAmount | number }}
            </td>
          </ng-container>

          <ng-container matColumnDef="tenureMonths">
            <th mat-header-cell *matHeaderCellDef>Tenure</th>
            <td mat-cell *matCellDef="let r">
              {{ r.tenureMonths }} months
            </td>
          </ng-container>

          <ng-container matColumnDef="purpose">
            <th mat-header-cell *matHeaderCellDef>Purpose</th>
            <td mat-cell *matCellDef="let r">
              {{ r.purpose }}
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef>Action</th>
            <td mat-cell *matCellDef="let r">
              <button
                mat-raised-button
                color="primary"
                class="review-btn"
                aria-label="Review credit request"
                (click)="review(r.id)">
                Review
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

        </table>
      </ng-template>

    </mat-card>
  </main>

  <!-- FOOTER -->
  <app-footer></app-footer>

</div>
